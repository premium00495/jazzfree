document.getElementById('submitBtn').addEventListener('click', checkKey);

async function checkKey(){
  const key = document.getElementById('accessKey').value.trim();
  const msg = document.getElementById('msg');
  msg.textContent = '';

  if(!key){ msg.textContent = 'Please enter key'; return; }

  try {
    const res = await fetch('/api/validateKey', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ key })
    });

    const data = await res.json();
    if(data.valid){
      window.location.href = '/dashboard'; // Protected page
    } else {
      msg.textContent = 'Invalid key';
    }
  } catch(err) {
    msg.textContent = 'Server error';
    console.error(err);
  }
}
